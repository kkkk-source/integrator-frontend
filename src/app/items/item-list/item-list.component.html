<!-- table -->
<div style="overflow-x: visible; min-height: 365px" class="table-responsive h-auto">
  <table class="table align-items-center table-flush">
    <thead class="thead-light">
      <tr>
        <th scope="col">Name</th>
        <th scope="col">Description</th>
        <th scope="col">Price</th>
        <th scope="col">Quantity</th>
        <th scope="col">Updated At</th>
        <th scope="col">Created At</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of items; let i = index">
        <th scope="row">
          <div class="media-body">
            <span class="mb-0 text-sm">{{ item.name }}</span>
          </div>
        </th>

        <td>{{ item.description }}</td>
        <td>{{ item.price | currency: 'USD':'symbol':'1.0-1' }}</td>
        <td>{{ item.quantity }}</td>
        <td>{{ item.updatedAt | date: 'short' }}</td>
        <td>{{ item.createdAt | date: 'short' }}</td>

        <td class="text-right">
          <div ngbDropdown placement="bottom-right">
            <a class="btn btn-sm btn-icon-only text-light" ngbDropdownToggle>
              <i class="fas fa-ellipsis-v"></i>
            </a>
            <div ngbDropdownMenu class="dropdown-menu-right dropdown-menu-arrow">
              <a class="dropdown-item" (click)="openEditingModal(editModal, i)" href="#">Edit</a>
              <a class="dropdown-item" (click)="openRemovingModal(removeModal, i)" href="#">Delete</a>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- pagination -->
<div class="card-footer py-4">
  <nav aria-label="...">
    <ul class="pagination justify-content-end mb-0">
      <ngb-pagination
        (pageChange)="pageChange($event)"
        [collectionSize]="collectionSize"
        [pageSize]="pageSize"
        [(page)]="page"
        aria-label="Default pagination"
      ></ngb-pagination>
    </ul>
  </nav>
</div>

<!-- remove modal -->
<ng-template #removeModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-title">Removing Item</h4>
    <button type="button" class="close" aria-describedby="modal-title" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <p>
      <strong
        >Are you sure you want to delete <span class="text-primary">{{ itemToDelete.name }}</span> item?</strong
      >
    </p>
    <p>
      All information associated to this item will be permanently deleted.
      <span class="text-danger">This operation can not be undone.</span>
    </p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-secondary" (click)="modal.dismiss('cancel click')">Cancel</button>
    <button type="button" class="btn btn-danger" (click)="modal.close('Ok click')">Confirm</button>
  </div>
</ng-template>

<!-- modal -->
<ng-template #editModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Editing Item</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click'); itemEditForm.reset()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="itemEditForm">
      <div class="form-group">
        <label for="name">
          <label for="validationServer01">Name: </label>
          <strong><abbr title="required">*</abbr></strong>
        </label>

        <input
          formControlName="name"
          id="name"
          type="text"
          style="transition: none"
          [ngClass]="[
            'form-control',
            itemEditForm.controls['name']?.dirty && itemEditForm.controls['name']?.valid ? 'is-valid' : '',
            itemEditForm.controls['name']?.dirty && itemEditForm.controls['name']?.invalid ? 'is-invalid' : ''
          ]"
          placeholder="Item's Name"
          required
        />
        <div
          *ngIf="itemEditForm.controls['name']?.dirty && itemEditForm.controls['name']?.invalid"
          class="invalid-feedback"
        >
          Please provide a valid name.
        </div>
      </div>

      <div class="form-group">
        <label for="name">
          <label for="validationServer01">Description: </label>
        </label>
        <input
          formControlName="description"
          id="description"
          type="text"
          style="transition: none"
          [ngClass]="[
            'form-control',
            itemEditForm.controls['description']?.dirty && itemEditForm.controls['description']?.valid
              ? 'is-valid'
              : '',
            itemEditForm.controls['description']?.dirty && itemEditForm.controls['description']?.invalid
              ? 'is-invalid'
              : ''
          ]"
          value=""
          placeholder="Item's Description"
        />
        <div
          *ngIf="itemEditForm.controls['description']?.dirty && itemEditForm.controls['description']?.invalid"
          class="invalid-feedback"
        >
          Please provide a valid description.
        </div>
      </div>

      <div class="form-row">
        <div class="col-sm">
          <label for="validationServer03">Price: </label>
          <strong><abbr title="required">*</abbr></strong>
          <input
            formControlName="price"
            id="price"
            type="text"
            style="transition: none"
            [ngClass]="[
              'form-control',
              itemEditForm.controls['price']?.dirty && itemEditForm.controls['price']?.valid ? 'is-valid' : '',
              itemEditForm.controls['price']?.dirty && itemEditForm.controls['price']?.invalid ? 'is-invalid' : ''
            ]"
            placeholder="Price"
            required
          />
          <div class="invalid-feedback">Please provide a valid amount.</div>
        </div>

        <div class="col-sm">
          <label for="validationServer04">Quantity: </label>
          <strong><abbr title="required">*</abbr></strong>
          <input
            formControlName="quantity"
            id="quantity"
            type="text"
            style="transition: none"
            [ngClass]="[
              'form-control',
              itemEditForm.controls['quantity']?.dirty && itemEditForm.controls['quantity']?.valid ? 'is-valid' : '',
              itemEditForm.controls['quantity']?.dirty && itemEditForm.controls['quantity']?.invalid ? 'is-invalid' : ''
            ]"
            placeholder="Quantity"
            value="0"
            required
          />
          <div
            *ngIf="itemEditForm.controls['quantity']?.dirty && itemEditForm.controls['quantity']?.invalid"
            class="invalid-feedback"
          >
            Please provide a valid quantity.
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button
      type="submit"
      [disabled]="!itemEditForm.valid"
      [ngClass]="['btn', itemEditForm.valid ? 'btn-outline-primary' : 'btn-link']"
      (click)="modal.close('Ok click')"
    >
      Edit
    </button>
  </div>
</ng-template>
